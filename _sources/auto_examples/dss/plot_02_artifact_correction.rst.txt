
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/dss/plot_02_artifact_correction.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_dss_plot_02_artifact_correction.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_dss_plot_02_artifact_correction.py:


Artifact Correction with DSS.
=============================

DSS is a powerful tool for removing artifacts (ECG, EOG) from data.
The core idea is: **Artifacts are repetitive**.

If we can define when artifacts happen (e.g., using EOG/ECG channels),
we can use **Trial Average Bias** to find the artifact source and remove it.

This tutorial demonstrates:
1.  **EOG (Blink) Correction**: Epoching on blinks and using DSS to find the blink component.
2.  **ECG (Heartbeat) Correction**: Epoching on heartbeats and finding the cardiac component.

Authors: Sina Esmaeili (sina.esmaeili@umontreal.ca)
         Hamza Abdelhedi (hamza.abdelhedi@umontreal.ca)

.. GENERATED FROM PYTHON SOURCE LINES 20-22

Imports
-------

.. GENERATED FROM PYTHON SOURCE LINES 22-41

.. code-block:: Python

    import contextlib
    import os

    import matplotlib.pyplot as plt
    import mne
    import numpy as np
    from mne.datasets import sample
    from mne.preprocessing import create_ecg_epochs, create_eog_epochs

    from mne_denoise.dss import DSS, AverageBias, CycleAverageBias
    from mne_denoise.viz import (
        plot_component_summary,
        plot_component_time_series,
        plot_evoked_comparison,
        plot_psd_comparison,
        plot_score_curve,
        plot_spatial_patterns,
    )








.. GENERATED FROM PYTHON SOURCE LINES 42-45

Load Data
---------
We use the MNE sample dataset which contains clear ECG and EOG artifacts.

.. GENERATED FROM PYTHON SOURCE LINES 45-61

.. code-block:: Python


    print("Loading MNE Sample data...")
    # Ensure MNE_DATA directory exists
    home = os.path.expanduser("~")
    mne_data_path = os.path.join(home, "mne_data")
    if not os.path.exists(mne_data_path):
        with contextlib.suppress(OSError):
            os.makedirs(mne_data_path)

    data_path = sample.data_path()
    raw_fname = data_path / "MEG" / "sample" / "sample_audvis_raw.fif"
    raw = mne.io.read_raw_fif(raw_fname, preload=True, verbose=False)
    raw.crop(0, 60)  # Keep full duration but no picking yet
    print(f"Data: {len(raw.ch_names)} channels (MEG, EEG, EOG, ECG), 60s duration")






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Loading MNE Sample data...
    Data: 376 channels (MEG, EEG, EOG, ECG), 60s duration




.. GENERATED FROM PYTHON SOURCE LINES 62-67

Part 1: EOG (Blink) Correction
------------------------------
**Goal**: Remove eye blinks.
**Bias**: We epoch the data around blink events (found via EOG channel).
The "blink artifact" is the component that is most consistent across these epochs.

.. GENERATED FROM PYTHON SOURCE LINES 67-88

.. code-block:: Python


    print("\n--- Part 1: EOG (Blink) Correction ---")

    # 1. Create EOG Epochs
    eog_epochs = create_eog_epochs(
        raw, ch_name="EOG 061", baseline=(-0.5, -0.2), tmin=-0.5, tmax=0.5, verbose=False
    )
    # IMPORTANT: DSS should be fitted on the data channels (MEG) we want to clean.
    # We exclude the EOG channel itself from the model.
    eog_epochs.pick_types(meg="grad", eog=False, ecg=False)
    print(
        f"Found {len(eog_epochs)} blink events. Using {len(eog_epochs.ch_names)} MEG channels."
    )

    # 2. Fit DSS with Trial Average Bias
    # We use AverageBias(axis='epochs') which works on pre-epoched data.
    # Note: We'll compare with CycleAverageBias later (artifact-specific approach).

    dss_eog = DSS(n_components=10, bias=AverageBias(axis="epochs"), return_type="sources")
    dss_eog.fit(eog_epochs)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    --- Part 1: EOG (Blink) Correction ---
    NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
    Found 10 blink events. Using 203 MEG channels.
    /home/runner/work/mne-denoise/mne-denoise/mne_denoise/dss/linear.py:492: RuntimeWarning: Epochs are not baseline corrected, covariance matrix may be inaccurate
      baseline_cov = mne.compute_covariance(inst, method=method, **kws)
    /home/runner/work/mne-denoise/mne-denoise/mne_denoise/dss/linear.py:494: RuntimeWarning: Epochs are not baseline corrected, covariance matrix may be inaccurate
      biased_cov = mne.compute_covariance(biased_inst, method=method, **kws)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-container-id-1 {
      /* Definition of color scheme common for light and dark mode */
      --sklearn-color-text: #000;
      --sklearn-color-text-muted: #666;
      --sklearn-color-line: gray;
      /* Definition of color scheme for unfitted estimators */
      --sklearn-color-unfitted-level-0: #fff5e6;
      --sklearn-color-unfitted-level-1: #f6e4d2;
      --sklearn-color-unfitted-level-2: #ffe0b3;
      --sklearn-color-unfitted-level-3: chocolate;
      /* Definition of color scheme for fitted estimators */
      --sklearn-color-fitted-level-0: #f0f8ff;
      --sklearn-color-fitted-level-1: #d4ebff;
      --sklearn-color-fitted-level-2: #b3dbfd;
      --sklearn-color-fitted-level-3: cornflowerblue;
    }

    #sk-container-id-1.light {
      /* Specific color for light theme */
      --sklearn-color-text-on-default-background: black;
      --sklearn-color-background: white;
      --sklearn-color-border-box: black;
      --sklearn-color-icon: #696969;
    }

    #sk-container-id-1.dark {
      --sklearn-color-text-on-default-background: white;
      --sklearn-color-background: #111;
      --sklearn-color-border-box: white;
      --sklearn-color-icon: #878787;
    }

    #sk-container-id-1 {
      color: var(--sklearn-color-text);
    }

    #sk-container-id-1 pre {
      padding: 0;
    }

    #sk-container-id-1 input.sk-hidden--visually {
      border: 0;
      clip: rect(1px 1px 1px 1px);
      clip: rect(1px, 1px, 1px, 1px);
      height: 1px;
      margin: -1px;
      overflow: hidden;
      padding: 0;
      position: absolute;
      width: 1px;
    }

    #sk-container-id-1 div.sk-dashed-wrapped {
      border: 1px dashed var(--sklearn-color-line);
      margin: 0 0.4em 0.5em 0.4em;
      box-sizing: border-box;
      padding-bottom: 0.4em;
      background-color: var(--sklearn-color-background);
    }

    #sk-container-id-1 div.sk-container {
      /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
         but bootstrap.min.css set `[hidden] { display: none !important; }`
         so we also need the `!important` here to be able to override the
         default hidden behavior on the sphinx rendered scikit-learn.org.
         See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
      display: inline-block !important;
      position: relative;
    }

    #sk-container-id-1 div.sk-text-repr-fallback {
      display: none;
    }

    div.sk-parallel-item,
    div.sk-serial,
    div.sk-item {
      /* draw centered vertical line to link estimators */
      background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
      background-size: 2px 100%;
      background-repeat: no-repeat;
      background-position: center center;
    }

    /* Parallel-specific style estimator block */

    #sk-container-id-1 div.sk-parallel-item::after {
      content: "";
      width: 100%;
      border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
      flex-grow: 1;
    }

    #sk-container-id-1 div.sk-parallel {
      display: flex;
      align-items: stretch;
      justify-content: center;
      background-color: var(--sklearn-color-background);
      position: relative;
    }

    #sk-container-id-1 div.sk-parallel-item {
      display: flex;
      flex-direction: column;
    }

    #sk-container-id-1 div.sk-parallel-item:first-child::after {
      align-self: flex-end;
      width: 50%;
    }

    #sk-container-id-1 div.sk-parallel-item:last-child::after {
      align-self: flex-start;
      width: 50%;
    }

    #sk-container-id-1 div.sk-parallel-item:only-child::after {
      width: 0;
    }

    /* Serial-specific style estimator block */

    #sk-container-id-1 div.sk-serial {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: var(--sklearn-color-background);
      padding-right: 1em;
      padding-left: 1em;
    }


    /* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
    clickable and can be expanded/collapsed.
    - Pipeline and ColumnTransformer use this feature and define the default style
    - Estimators will overwrite some part of the style using the `sk-estimator` class
    */

    /* Pipeline and ColumnTransformer style (default) */

    #sk-container-id-1 div.sk-toggleable {
      /* Default theme specific background. It is overwritten whether we have a
      specific estimator or a Pipeline/ColumnTransformer */
      background-color: var(--sklearn-color-background);
    }

    /* Toggleable label */
    #sk-container-id-1 label.sk-toggleable__label {
      cursor: pointer;
      display: flex;
      width: 100%;
      margin-bottom: 0;
      padding: 0.5em;
      box-sizing: border-box;
      text-align: center;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
    }

    #sk-container-id-1 label.sk-toggleable__label .caption {
      font-size: 0.6rem;
      font-weight: lighter;
      color: var(--sklearn-color-text-muted);
    }

    #sk-container-id-1 label.sk-toggleable__label-arrow:before {
      /* Arrow on the left of the label */
      content: "▸";
      float: left;
      margin-right: 0.25em;
      color: var(--sklearn-color-icon);
    }

    #sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
      color: var(--sklearn-color-text);
    }

    /* Toggleable content - dropdown */

    #sk-container-id-1 div.sk-toggleable__content {
      display: none;
      text-align: left;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-1 div.sk-toggleable__content.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-1 div.sk-toggleable__content pre {
      margin: 0.2em;
      border-radius: 0.25em;
      color: var(--sklearn-color-text);
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-1 div.sk-toggleable__content.fitted pre {
      /* unfitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
      /* Expand drop-down */
      display: block;
      width: 100%;
      overflow: visible;
    }

    #sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
      content: "▾";
    }

    /* Pipeline/ColumnTransformer-specific style */

    #sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator-specific style */

    /* Colorize estimator box */
    #sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    #sk-container-id-1 div.sk-label label.sk-toggleable__label,
    #sk-container-id-1 div.sk-label label {
      /* The background is the default theme color */
      color: var(--sklearn-color-text-on-default-background);
    }

    /* On hover, darken the color of the background */
    #sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    /* Label box, darken color on hover, fitted */
    #sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator label */

    #sk-container-id-1 div.sk-label label {
      font-family: monospace;
      font-weight: bold;
      line-height: 1.2em;
    }

    #sk-container-id-1 div.sk-label-container {
      text-align: center;
    }

    /* Estimator-specific */
    #sk-container-id-1 div.sk-estimator {
      font-family: monospace;
      border: 1px dotted var(--sklearn-color-border-box);
      border-radius: 0.25em;
      box-sizing: border-box;
      margin-bottom: 0.5em;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-1 div.sk-estimator.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    /* on hover */
    #sk-container-id-1 div.sk-estimator:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-1 div.sk-estimator.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Specification for estimator info (e.g. "i" and "?") */

    /* Common style for "i" and "?" */

    .sk-estimator-doc-link,
    a:link.sk-estimator-doc-link,
    a:visited.sk-estimator-doc-link {
      float: right;
      font-size: smaller;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-unfitted-level-0);
      border-radius: 1em;
      height: 1em;
      width: 1em;
      text-decoration: none !important;
      margin-left: 0.5em;
      text-align: center;
      /* unfitted */
      border: var(--sklearn-color-unfitted-level-3) 1pt solid;
      color: var(--sklearn-color-unfitted-level-3);
    }

    .sk-estimator-doc-link.fitted,
    a:link.sk-estimator-doc-link.fitted,
    a:visited.sk-estimator-doc-link.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-3) 1pt solid;
      color: var(--sklearn-color-fitted-level-3);
    }

    /* On hover */
    div.sk-estimator:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover,
    div.sk-label-container:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      border: var(--sklearn-color-fitted-level-0) 1pt solid;
      color: var(--sklearn-color-unfitted-level-0);
      text-decoration: none;
    }

    div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover,
    div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
      border: var(--sklearn-color-fitted-level-0) 1pt solid;
      color: var(--sklearn-color-fitted-level-0);
      text-decoration: none;
    }

    /* Span, style for the box shown on hovering the info icon */
    .sk-estimator-doc-link span {
      display: none;
      z-index: 9999;
      position: relative;
      font-weight: normal;
      right: .2ex;
      padding: .5ex;
      margin: .5ex;
      width: min-content;
      min-width: 20ex;
      max-width: 50ex;
      color: var(--sklearn-color-text);
      box-shadow: 2pt 2pt 4pt #999;
      /* unfitted */
      background: var(--sklearn-color-unfitted-level-0);
      border: .5pt solid var(--sklearn-color-unfitted-level-3);
    }

    .sk-estimator-doc-link.fitted span {
      /* fitted */
      background: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-3);
    }

    .sk-estimator-doc-link:hover span {
      display: block;
    }

    /* "?"-specific style due to the `<a>` HTML tag */

    #sk-container-id-1 a.estimator_doc_link {
      float: right;
      font-size: 1rem;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-unfitted-level-0);
      border-radius: 1rem;
      height: 1rem;
      width: 1rem;
      text-decoration: none;
      /* unfitted */
      color: var(--sklearn-color-unfitted-level-1);
      border: var(--sklearn-color-unfitted-level-1) 1pt solid;
    }

    #sk-container-id-1 a.estimator_doc_link.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-1) 1pt solid;
      color: var(--sklearn-color-fitted-level-1);
    }

    /* On hover */
    #sk-container-id-1 a.estimator_doc_link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    #sk-container-id-1 a.estimator_doc_link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
    }

    .estimator-table {
        font-family: monospace;
    }

    .estimator-table summary {
        padding: .5rem;
        cursor: pointer;
    }

    .estimator-table summary::marker {
        font-size: 0.7rem;
    }

    .estimator-table details[open] {
        padding-left: 0.1rem;
        padding-right: 0.1rem;
        padding-bottom: 0.3rem;
    }

    .estimator-table .parameters-table {
        margin-left: auto !important;
        margin-right: auto !important;
        margin-top: 0;
    }

    .estimator-table .parameters-table tr:nth-child(odd) {
        background-color: #fff;
    }

    .estimator-table .parameters-table tr:nth-child(even) {
        background-color: #f6f6f6;
    }

    .estimator-table .parameters-table tr:hover {
        background-color: #e0e0e0;
    }

    .estimator-table table td {
        border: 1px solid rgba(106, 105, 104, 0.232);
    }

    /*
        `table td`is set in notebook with right text-align.
        We need to overwrite it.
    */
    .estimator-table table td.param {
        text-align: left;
        position: relative;
        padding: 0;
    }

    .user-set td {
        color:rgb(255, 94, 0);
        text-align: left !important;
    }

    .user-set td.value {
        color:rgb(255, 94, 0);
        background-color: transparent;
    }

    .default td {
        color: black;
        text-align: left !important;
    }

    .user-set td i,
    .default td i {
        color: black;
    }

    /*
        Styles for parameter documentation links
        We need styling for visited so jupyter doesn't overwrite it
    */
    a.param-doc-link,
    a.param-doc-link:link,
    a.param-doc-link:visited {
        text-decoration: underline dashed;
        text-underline-offset: .3em;
        color: inherit;
        display: block;
        padding: .5em;
    }

    /* "hack" to make the entire area of the cell containing the link clickable */
    a.param-doc-link::before {
        position: absolute;
        content: "";
        inset: 0;
    }

    .param-doc-description {
        display: none;
        position: absolute;
        z-index: 9999;
        left: 0;
        padding: .5ex;
        margin-left: 1.5em;
        color: var(--sklearn-color-text);
        box-shadow: .3em .3em .4em #999;
        width: max-content;
        text-align: left;
        max-height: 10em;
        overflow-y: auto;

        /* unfitted */
        background: var(--sklearn-color-unfitted-level-0);
        border: thin solid var(--sklearn-color-unfitted-level-3);
    }

    /* Fitted state for parameter tooltips */
    .fitted .param-doc-description {
        /* fitted */
        background: var(--sklearn-color-fitted-level-0);
        border: thin solid var(--sklearn-color-fitted-level-3);
    }

    .param-doc-link:hover .param-doc-description {
        display: block;
    }

    .copy-paste-icon {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
        background-repeat: no-repeat;
        background-size: 14px 14px;
        background-position: 0;
        display: inline-block;
        width: 14px;
        height: 14px;
        cursor: pointer;
    }
    </style><body><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DSS(bias=&lt;mne_denoise.dss.denoisers.averaging.AverageBias object at 0x7ff14b0f0bc0&gt;,
        n_components=10)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>DSS</div></div><div><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
            <div class="estimator-table">
                <details>
                    <summary>Parameters</summary>
                    <table class="parameters-table">
                      <tbody>
                    
            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('bias',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">bias</td>
                <td class="value">&lt;mne_denoise....x7ff14b0f0bc0&gt;</td>
            </tr>
    

            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('n_components',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">n_components</td>
                <td class="value">10</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('rank',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">rank</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('reg',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">reg</td>
                <td class="value">1e-09</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('normalize_input',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">normalize_input</td>
                <td class="value">True</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('cov_method',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">cov_method</td>
                <td class="value">&#x27;empirical&#x27;</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('cov_kws',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">cov_kws</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('return_type',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">return_type</td>
                <td class="value">&#x27;sources&#x27;</td>
            </tr>
    
                      </tbody>
                    </table>
                </details>
            </div>
        </div></div></div></div></div><script>function copyToClipboard(text, element) {
        // Get the parameter prefix from the closest toggleable content
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

        const originalStyle = element.style;
        const computedStyle = window.getComputedStyle(element);
        const originalWidth = computedStyle.width;
        const originalHTML = element.innerHTML.replace('Copied!', '');

        navigator.clipboard.writeText(fullParamName)
            .then(() => {
                element.style.width = originalWidth;
                element.style.color = 'green';
                element.innerHTML = "Copied!";

                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            })
            .catch(err => {
                console.error('Failed to copy:', err);
                element.style.color = 'red';
                element.innerHTML = "Failed!";
                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            });
        return false;
    }

    document.querySelectorAll('.copy-paste-icon').forEach(function(element) {
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const paramName = element.parentElement.nextElementSibling
            .textContent.trim().split(' ')[0];
        const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

        element.setAttribute('title', fullParamName);
    });


    /**
     * Adapted from Skrub
     * https://github.com/skrub-data/skrub/blob/403466d1d5d4dc76a7ef569b3f8228db59a31dc3/skrub/_reporting/_data/templates/report.js#L789
     * @returns "light" or "dark"
     */
    function detectTheme(element) {
        const body = document.querySelector('body');

        // Check VSCode theme
        const themeKindAttr = body.getAttribute('data-vscode-theme-kind');
        const themeNameAttr = body.getAttribute('data-vscode-theme-name');

        if (themeKindAttr && themeNameAttr) {
            const themeKind = themeKindAttr.toLowerCase();
            const themeName = themeNameAttr.toLowerCase();

            if (themeKind.includes("dark") || themeName.includes("dark")) {
                return "dark";
            }
            if (themeKind.includes("light") || themeName.includes("light")) {
                return "light";
            }
        }

        // Check Jupyter theme
        if (body.getAttribute('data-jp-theme-light') === 'false') {
            return 'dark';
        } else if (body.getAttribute('data-jp-theme-light') === 'true') {
            return 'light';
        }

        // Guess based on a parent element's color
        const color = window.getComputedStyle(element.parentNode, null).getPropertyValue('color');
        const match = color.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i);
        if (match) {
            const [r, g, b] = [
                parseFloat(match[1]),
                parseFloat(match[2]),
                parseFloat(match[3])
            ];

            // https://en.wikipedia.org/wiki/HSL_and_HSV#Lightness
            const luma = 0.299 * r + 0.587 * g + 0.114 * b;

            if (luma > 180) {
                // If the text is very bright we have a dark theme
                return 'dark';
            }
            if (luma < 75) {
                // If the text is very dark we have a light theme
                return 'light';
            }
            // Otherwise fall back to the next heuristic.
        }

        // Fallback to system preference
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }


    function forceTheme(elementId) {
        const estimatorElement = document.querySelector(`#${elementId}`);
        if (estimatorElement === null) {
            console.error(`Element with id ${elementId} not found.`);
        } else {
            const theme = detectTheme(estimatorElement);
            estimatorElement.classList.add(theme);
        }
    }

    forceTheme('sk-container-id-1');</script></body>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 89-91

Visualize Blink Components
--------------------------

.. GENERATED FROM PYTHON SOURCE LINES 91-107

.. code-block:: Python


    # 1. Score Curve
    # *   **Expectation**: Comp 0 should have a very high score (reproducible bias).
    plot_score_curve(dss_eog, mode="ratio", show=False)

    # 2. Time Series
    # *   **Expectation**: Comp 0 should look like a classic "V-shape" or bell-shape blink.
    plot_component_time_series(dss_eog, data=eog_epochs, n_components=10, show=False)

    # 3. Spatial Patterns
    # *   **Expectation**: Comp 0 should be strictly frontal.
    plot_spatial_patterns(dss_eog, n_components=10, show=False)

    # 4. Summary (Topo + Time + PSD)
    plot_component_summary(dss_eog, data=eog_epochs, n_components=[0, 1], show=False)




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_001.png
         :alt: Component Scores
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_002.png
         :alt: First 10 Component Time Series
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_003.png
         :alt: Comp 0, Comp 1, Comp 2, Comp 3, Comp 4, Comp 5, Comp 6, Comp 7, Comp 8, Comp 9, fT/cm
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_004.png
         :alt: Comp 0 Pattern, Comp 0 Time Course, PSD, Comp 1 Pattern, Comp 1 Time Course, PSD
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_004.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <Figure size 1200x600 with 6 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 108-112

5. Denoising Comparison
-----------------------
We project the data into the DSS space, **zero out** the first component (the blink),
and project back.

.. GENERATED FROM PYTHON SOURCE LINES 112-172

.. code-block:: Python


    print("Removing blink component...")
    # Transform continuous data
    # We must ensure we apply to the same channels used in fit (the gradiometers).
    raw_meg = raw.copy().pick_types(meg="grad", eeg=False, eog=False, ecg=False)
    sources = dss_eog.transform(raw_meg)

    # Check Correlation with EOG channel
    # This validates that Comp 0 is indeed the blink artifact.
    eog_picks = mne.pick_types(raw.info, meg=False, eog=True)
    if len(eog_picks) > 0:
        eog_data = raw.get_data(picks=eog_picks[0]).flatten()
        blink_source = sources[0, :]
        for i in range(3):
            comp_source = sources[i, :]
            corr = np.corrcoef(eog_data, comp_source)[0, 1]
            print(f"Correlation (Comp {i} vs EOG): {abs(corr):.3f}")
    else:
        print("No EOG channel found for correlation check.")
        # Create dummy data for plot to avoid crash, or skip plot?
        # We'll skip plot logic if no channel, but for now let's hope it exists.
        eog_data = np.zeros(len(sources[0]))
        blink_source = sources[0, :]

    # Visual Comparison: EOG vs Component 0
    # Show a time window with clear blinks, scaled and aligned

    # Find a window with blinks (sample 5000-10000)
    start_idx, end_idx = 5000, 10000
    t_window = np.arange(start_idx, end_idx) / raw.info["sfreq"]

    # Get data snippets
    eog_snippet = eog_data[start_idx:end_idx]
    comp_snippet = blink_source[start_idx:end_idx]

    # Flip component if negatively correlated
    corr_window = np.corrcoef(eog_snippet, comp_snippet)[0, 1]
    flip = -1 if corr_window < 0 else 1

    # Scale component to match EOG amplitude
    scale = np.max(np.abs(eog_snippet)) / np.max(np.abs(comp_snippet))

    plt.figure(figsize=(12, 4))
    plt.plot(t_window, eog_snippet, "b", linewidth=1.5, label="EOG Channel")
    plt.plot(
        t_window,
        flip * comp_snippet * scale,
        "r",
        linewidth=1.5,
        label="DSS Comp 0 (aligned & scaled)",
        alpha=0.8,
    )
    plt.xlabel("Time (s)")
    plt.ylabel("Amplitude (a.u.)")
    plt.title(f"TrialAverageBias: Blink Peaks Aligned (r={abs(corr):.3f})")
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show(block=False)




.. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_005.png
   :alt: TrialAverageBias: Blink Peaks Aligned (r=0.045)
   :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Removing blink component...
    NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
    Correlation (Comp 0 vs EOG): 0.682
    Correlation (Comp 1 vs EOG): 0.340
    Correlation (Comp 2 vs EOG): 0.045




.. GENERATED FROM PYTHON SOURCE LINES 173-177

Alternative: CycleAverageBias (Continuous Data Approach)
=========================================================
CycleAverageBias is artifact-specific and works directly on continuous data.
Instead of pre-epoching, we provide event samples and a window.

.. GENERATED FROM PYTHON SOURCE LINES 177-199

.. code-block:: Python


    print("\n---  Comparing with CycleAverageBias ---")

    # Find blink events from continuous data
    from mne.preprocessing import find_eog_events

    blink_events = find_eog_events(raw, ch_name="EOG 061", verbose=False)
    blink_samples = blink_events[:, 0]

    print(f"Found {len(blink_samples)} blink events")

    # Create CycleAverageBias
    # Window: 100ms before to 100ms after each blink (in samples)
    window_samples = (-int(0.1 * raw.info["sfreq"]), int(0.1 * raw.info["sfreq"]))
    bias_cycle = CycleAverageBias(event_samples=blink_samples, window=window_samples)

    # Fit DSS on continuous MEG data
    dss_cycle = DSS(n_components=10, bias=bias_cycle, return_type="sources")
    dss_cycle.fit(raw_meg)

    print("Fitted DSS with CycleAverageBias")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    ---  Comparing with CycleAverageBias ---
    Found 10 blink events
    Fitted DSS with CycleAverageBias




.. GENERATED FROM PYTHON SOURCE LINES 200-202

Visualize Cycle Average Components
-----------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 202-221

.. code-block:: Python


    plot_component_summary(dss_cycle, data=raw_meg, n_components=[0, 1], show=False)
    plt.gcf().suptitle("CycleAverageBias Results")
    plt.show(block=False)

    # Compare spatial patterns (both bias types)
    print("\n--- Comparing Spatial Patterns ---")
    plot_spatial_patterns(dss_eog, n_components=1, show=False)
    plt.gcf().suptitle("TrialAverageBias: Blink Component Topography")
    plt.show(block=False)

    plot_spatial_patterns(dss_cycle, n_components=1, show=False)
    plt.gcf().suptitle("CycleAverageBias: Blink Component Topography")
    plt.show(block=False)

    print("\nBoth approaches extract the same blink artifact!")
    print("- TrialAverageBias: Works on MNE Epochs (easier integration)")
    print("- CycleAverageBias: Works on continuous data + event samples (more direct)")




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_006.png
         :alt: CycleAverageBias Results, Comp 0 Pattern, Comp 0 Time Course, PSD, Comp 1 Pattern, Comp 1 Time Course, PSD
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_006.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_007.png
         :alt: TrialAverageBias: Blink Component Topography, Comp 0, fT/cm
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_007.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_008.png
         :alt: CycleAverageBias: Blink Component Topography, Comp 0, fT/cm
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_008.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    --- Comparing Spatial Patterns ---

    Both approaches extract the same blink artifact!
    - TrialAverageBias: Works on MNE Epochs (easier integration)
    - CycleAverageBias: Works on continuous data + event samples (more direct)




.. GENERATED FROM PYTHON SOURCE LINES 222-284

.. code-block:: Python

    n_samples_plot = int(20 * raw.info["sfreq"])  # Plot 20 seconds
    scaler_eog = 1.0 / np.std(eog_data[:n_samples_plot])
    scaler_dss = 1.0 / np.std(blink_source[:n_samples_plot])

    # Flip DSS source if anti-correlated for better visual comparison
    corr_0 = np.corrcoef(eog_data, blink_source)[0, 1]
    sign = np.sign(corr_0)
    if sign == 0:
        sign = 1

    plt.figure(figsize=(10, 4))
    times_plot = raw.times[:n_samples_plot]
    plt.plot(
        times_plot,
        eog_data[:n_samples_plot] * scaler_eog,
        label="EOG Channel (Norm)",
        color="tab:orange",
        alpha=0.7,
    )
    plt.plot(
        times_plot,
        blink_source[:n_samples_plot] * scaler_dss * sign,
        label="DSS Comp 0 (Sign-Matched)",
        color="tab:blue",
        alpha=0.7,
    )
    plt.title(f"Temporal Comparison: EOG vs DSS Comp 0 (Corr={abs(corr_0):.2f})")
    plt.xlabel("Time (s)")
    plt.legend()
    plt.tight_layout()
    plt.show()

    # Zero out blink
    sources[0, :] = 0  # Remove Comp 0

    # Reconstruct
    cleaned_data = dss_eog.inverse_transform(sources)
    raw_clean_eog = mne.io.RawArray(cleaned_data, raw_meg.info)

    # Compare Raw vs Cleaned on the Blink Epochs
    # We verify improvement by looking at the average blink before/after.
    # (We need to re-epoch the cleaned data to compare apples-to-apples)
    eog_epochs_clean = mne.Epochs(
        raw_clean_eog,
        eog_epochs.events,
        tmin=-0.5,
        tmax=0.5,
        baseline=(-0.5, -0.2),
        verbose=False,
    )

    print("Plotting correction effect...")
    # Expectation 1: The huge blink artifact in the 'Original' trace should be gone or massive reduced.
    plot_evoked_comparison(
        eog_epochs, eog_epochs_clean, show=False, labels=("Original", "Cleaned")
    )

    # Expectation 2: The PSD should be largely unchanged in the alpha/beta bands.
    # Blinks are mostly low-frequency (<5 Hz). We want to ensure we didn't distort brain rhythms.
    plot_psd_comparison(eog_epochs, eog_epochs_clean, fmax=40, show=True)





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_009.png
         :alt: Temporal Comparison: EOG vs DSS Comp 0 (Corr=0.68)
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_009.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_010.png
         :alt: Evoked Response Comparison (GFP)
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_010.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_011.png
         :alt: PSD Comparison
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_011.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Creating RawArray with float64 data, n_channels=203, n_times=36038
        Range : 0 ... 36037 =      0.000 ...    60.000 secs
    Ready.
    Plotting correction effect...
    Using data from preloaded Raw for 10 events and 601 original time points ...
    6 bad epochs dropped
    Using data from preloaded Raw for 4 events and 601 original time points ...
        Using multitaper spectrum estimation with 7 DPSS windows
    Using data from preloaded Raw for 4 events and 601 original time points ...
        Using multitaper spectrum estimation with 7 DPSS windows

    <Figure size 640x480 with 1 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 285-289

Part 2: ECG (Heartbeat) Correction
----------------------------------
**Goal**: Remove cardiac field artifact.
**Bias**: Epoch around heartbeat (R-peak).

.. GENERATED FROM PYTHON SOURCE LINES 289-306

.. code-block:: Python


    print("\n--- Part 2: ECG (Heartbeat) Correction ---")

    # 1. Create ECG Epochs
    # We let MNE find the ECG channel automatically (looking for type='ecg')
    ecg_epochs = create_ecg_epochs(
        raw, ch_name=None, tmin=-0.1, tmax=0.1, baseline=(None, 0), verbose=False
    )
    ecg_epochs.pick_types(meg="grad", eeg=False, eog=False, ecg=False)
    print(
        f"Found {len(ecg_epochs)} heartbeats. Using {len(ecg_epochs.ch_names)} MEG channels."
    )

    # 2. Fit DSS
    dss_ecg = DSS(n_components=8, bias=AverageBias(axis="epochs"))
    dss_ecg.fit(ecg_epochs)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    --- Part 2: ECG (Heartbeat) Correction ---
    NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
    Found 59 heartbeats. Using 203 MEG channels.
    /home/runner/work/mne-denoise/mne-denoise/mne_denoise/dss/linear.py:492: RuntimeWarning: Epochs are not baseline corrected, covariance matrix may be inaccurate
      baseline_cov = mne.compute_covariance(inst, method=method, **kws)
    /home/runner/work/mne-denoise/mne-denoise/mne_denoise/dss/linear.py:494: RuntimeWarning: Epochs are not baseline corrected, covariance matrix may be inaccurate
      biased_cov = mne.compute_covariance(biased_inst, method=method, **kws)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <style>#sk-container-id-2 {
      /* Definition of color scheme common for light and dark mode */
      --sklearn-color-text: #000;
      --sklearn-color-text-muted: #666;
      --sklearn-color-line: gray;
      /* Definition of color scheme for unfitted estimators */
      --sklearn-color-unfitted-level-0: #fff5e6;
      --sklearn-color-unfitted-level-1: #f6e4d2;
      --sklearn-color-unfitted-level-2: #ffe0b3;
      --sklearn-color-unfitted-level-3: chocolate;
      /* Definition of color scheme for fitted estimators */
      --sklearn-color-fitted-level-0: #f0f8ff;
      --sklearn-color-fitted-level-1: #d4ebff;
      --sklearn-color-fitted-level-2: #b3dbfd;
      --sklearn-color-fitted-level-3: cornflowerblue;
    }

    #sk-container-id-2.light {
      /* Specific color for light theme */
      --sklearn-color-text-on-default-background: black;
      --sklearn-color-background: white;
      --sklearn-color-border-box: black;
      --sklearn-color-icon: #696969;
    }

    #sk-container-id-2.dark {
      --sklearn-color-text-on-default-background: white;
      --sklearn-color-background: #111;
      --sklearn-color-border-box: white;
      --sklearn-color-icon: #878787;
    }

    #sk-container-id-2 {
      color: var(--sklearn-color-text);
    }

    #sk-container-id-2 pre {
      padding: 0;
    }

    #sk-container-id-2 input.sk-hidden--visually {
      border: 0;
      clip: rect(1px 1px 1px 1px);
      clip: rect(1px, 1px, 1px, 1px);
      height: 1px;
      margin: -1px;
      overflow: hidden;
      padding: 0;
      position: absolute;
      width: 1px;
    }

    #sk-container-id-2 div.sk-dashed-wrapped {
      border: 1px dashed var(--sklearn-color-line);
      margin: 0 0.4em 0.5em 0.4em;
      box-sizing: border-box;
      padding-bottom: 0.4em;
      background-color: var(--sklearn-color-background);
    }

    #sk-container-id-2 div.sk-container {
      /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
         but bootstrap.min.css set `[hidden] { display: none !important; }`
         so we also need the `!important` here to be able to override the
         default hidden behavior on the sphinx rendered scikit-learn.org.
         See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
      display: inline-block !important;
      position: relative;
    }

    #sk-container-id-2 div.sk-text-repr-fallback {
      display: none;
    }

    div.sk-parallel-item,
    div.sk-serial,
    div.sk-item {
      /* draw centered vertical line to link estimators */
      background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
      background-size: 2px 100%;
      background-repeat: no-repeat;
      background-position: center center;
    }

    /* Parallel-specific style estimator block */

    #sk-container-id-2 div.sk-parallel-item::after {
      content: "";
      width: 100%;
      border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
      flex-grow: 1;
    }

    #sk-container-id-2 div.sk-parallel {
      display: flex;
      align-items: stretch;
      justify-content: center;
      background-color: var(--sklearn-color-background);
      position: relative;
    }

    #sk-container-id-2 div.sk-parallel-item {
      display: flex;
      flex-direction: column;
    }

    #sk-container-id-2 div.sk-parallel-item:first-child::after {
      align-self: flex-end;
      width: 50%;
    }

    #sk-container-id-2 div.sk-parallel-item:last-child::after {
      align-self: flex-start;
      width: 50%;
    }

    #sk-container-id-2 div.sk-parallel-item:only-child::after {
      width: 0;
    }

    /* Serial-specific style estimator block */

    #sk-container-id-2 div.sk-serial {
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: var(--sklearn-color-background);
      padding-right: 1em;
      padding-left: 1em;
    }


    /* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
    clickable and can be expanded/collapsed.
    - Pipeline and ColumnTransformer use this feature and define the default style
    - Estimators will overwrite some part of the style using the `sk-estimator` class
    */

    /* Pipeline and ColumnTransformer style (default) */

    #sk-container-id-2 div.sk-toggleable {
      /* Default theme specific background. It is overwritten whether we have a
      specific estimator or a Pipeline/ColumnTransformer */
      background-color: var(--sklearn-color-background);
    }

    /* Toggleable label */
    #sk-container-id-2 label.sk-toggleable__label {
      cursor: pointer;
      display: flex;
      width: 100%;
      margin-bottom: 0;
      padding: 0.5em;
      box-sizing: border-box;
      text-align: center;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
    }

    #sk-container-id-2 label.sk-toggleable__label .caption {
      font-size: 0.6rem;
      font-weight: lighter;
      color: var(--sklearn-color-text-muted);
    }

    #sk-container-id-2 label.sk-toggleable__label-arrow:before {
      /* Arrow on the left of the label */
      content: "▸";
      float: left;
      margin-right: 0.25em;
      color: var(--sklearn-color-icon);
    }

    #sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
      color: var(--sklearn-color-text);
    }

    /* Toggleable content - dropdown */

    #sk-container-id-2 div.sk-toggleable__content {
      display: none;
      text-align: left;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-2 div.sk-toggleable__content.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-2 div.sk-toggleable__content pre {
      margin: 0.2em;
      border-radius: 0.25em;
      color: var(--sklearn-color-text);
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-2 div.sk-toggleable__content.fitted pre {
      /* unfitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    #sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
      /* Expand drop-down */
      display: block;
      width: 100%;
      overflow: visible;
    }

    #sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
      content: "▾";
    }

    /* Pipeline/ColumnTransformer-specific style */

    #sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator-specific style */

    /* Colorize estimator box */
    #sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    #sk-container-id-2 div.sk-label label.sk-toggleable__label,
    #sk-container-id-2 div.sk-label label {
      /* The background is the default theme color */
      color: var(--sklearn-color-text-on-default-background);
    }

    /* On hover, darken the color of the background */
    #sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    /* Label box, darken color on hover, fitted */
    #sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
      color: var(--sklearn-color-text);
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Estimator label */

    #sk-container-id-2 div.sk-label label {
      font-family: monospace;
      font-weight: bold;
      line-height: 1.2em;
    }

    #sk-container-id-2 div.sk-label-container {
      text-align: center;
    }

    /* Estimator-specific */
    #sk-container-id-2 div.sk-estimator {
      font-family: monospace;
      border: 1px dotted var(--sklearn-color-border-box);
      border-radius: 0.25em;
      box-sizing: border-box;
      margin-bottom: 0.5em;
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-0);
    }

    #sk-container-id-2 div.sk-estimator.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
    }

    /* on hover */
    #sk-container-id-2 div.sk-estimator:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-2);
    }

    #sk-container-id-2 div.sk-estimator.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-2);
    }

    /* Specification for estimator info (e.g. "i" and "?") */

    /* Common style for "i" and "?" */

    .sk-estimator-doc-link,
    a:link.sk-estimator-doc-link,
    a:visited.sk-estimator-doc-link {
      float: right;
      font-size: smaller;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-unfitted-level-0);
      border-radius: 1em;
      height: 1em;
      width: 1em;
      text-decoration: none !important;
      margin-left: 0.5em;
      text-align: center;
      /* unfitted */
      border: var(--sklearn-color-unfitted-level-3) 1pt solid;
      color: var(--sklearn-color-unfitted-level-3);
    }

    .sk-estimator-doc-link.fitted,
    a:link.sk-estimator-doc-link.fitted,
    a:visited.sk-estimator-doc-link.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-3) 1pt solid;
      color: var(--sklearn-color-fitted-level-3);
    }

    /* On hover */
    div.sk-estimator:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover,
    div.sk-label-container:hover .sk-estimator-doc-link:hover,
    .sk-estimator-doc-link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      border: var(--sklearn-color-fitted-level-0) 1pt solid;
      color: var(--sklearn-color-unfitted-level-0);
      text-decoration: none;
    }

    div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover,
    div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
    .sk-estimator-doc-link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
      border: var(--sklearn-color-fitted-level-0) 1pt solid;
      color: var(--sklearn-color-fitted-level-0);
      text-decoration: none;
    }

    /* Span, style for the box shown on hovering the info icon */
    .sk-estimator-doc-link span {
      display: none;
      z-index: 9999;
      position: relative;
      font-weight: normal;
      right: .2ex;
      padding: .5ex;
      margin: .5ex;
      width: min-content;
      min-width: 20ex;
      max-width: 50ex;
      color: var(--sklearn-color-text);
      box-shadow: 2pt 2pt 4pt #999;
      /* unfitted */
      background: var(--sklearn-color-unfitted-level-0);
      border: .5pt solid var(--sklearn-color-unfitted-level-3);
    }

    .sk-estimator-doc-link.fitted span {
      /* fitted */
      background: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-3);
    }

    .sk-estimator-doc-link:hover span {
      display: block;
    }

    /* "?"-specific style due to the `<a>` HTML tag */

    #sk-container-id-2 a.estimator_doc_link {
      float: right;
      font-size: 1rem;
      line-height: 1em;
      font-family: monospace;
      background-color: var(--sklearn-color-unfitted-level-0);
      border-radius: 1rem;
      height: 1rem;
      width: 1rem;
      text-decoration: none;
      /* unfitted */
      color: var(--sklearn-color-unfitted-level-1);
      border: var(--sklearn-color-unfitted-level-1) 1pt solid;
    }

    #sk-container-id-2 a.estimator_doc_link.fitted {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-0);
      border: var(--sklearn-color-fitted-level-1) 1pt solid;
      color: var(--sklearn-color-fitted-level-1);
    }

    /* On hover */
    #sk-container-id-2 a.estimator_doc_link:hover {
      /* unfitted */
      background-color: var(--sklearn-color-unfitted-level-3);
      color: var(--sklearn-color-background);
      text-decoration: none;
    }

    #sk-container-id-2 a.estimator_doc_link.fitted:hover {
      /* fitted */
      background-color: var(--sklearn-color-fitted-level-3);
    }

    .estimator-table {
        font-family: monospace;
    }

    .estimator-table summary {
        padding: .5rem;
        cursor: pointer;
    }

    .estimator-table summary::marker {
        font-size: 0.7rem;
    }

    .estimator-table details[open] {
        padding-left: 0.1rem;
        padding-right: 0.1rem;
        padding-bottom: 0.3rem;
    }

    .estimator-table .parameters-table {
        margin-left: auto !important;
        margin-right: auto !important;
        margin-top: 0;
    }

    .estimator-table .parameters-table tr:nth-child(odd) {
        background-color: #fff;
    }

    .estimator-table .parameters-table tr:nth-child(even) {
        background-color: #f6f6f6;
    }

    .estimator-table .parameters-table tr:hover {
        background-color: #e0e0e0;
    }

    .estimator-table table td {
        border: 1px solid rgba(106, 105, 104, 0.232);
    }

    /*
        `table td`is set in notebook with right text-align.
        We need to overwrite it.
    */
    .estimator-table table td.param {
        text-align: left;
        position: relative;
        padding: 0;
    }

    .user-set td {
        color:rgb(255, 94, 0);
        text-align: left !important;
    }

    .user-set td.value {
        color:rgb(255, 94, 0);
        background-color: transparent;
    }

    .default td {
        color: black;
        text-align: left !important;
    }

    .user-set td i,
    .default td i {
        color: black;
    }

    /*
        Styles for parameter documentation links
        We need styling for visited so jupyter doesn't overwrite it
    */
    a.param-doc-link,
    a.param-doc-link:link,
    a.param-doc-link:visited {
        text-decoration: underline dashed;
        text-underline-offset: .3em;
        color: inherit;
        display: block;
        padding: .5em;
    }

    /* "hack" to make the entire area of the cell containing the link clickable */
    a.param-doc-link::before {
        position: absolute;
        content: "";
        inset: 0;
    }

    .param-doc-description {
        display: none;
        position: absolute;
        z-index: 9999;
        left: 0;
        padding: .5ex;
        margin-left: 1.5em;
        color: var(--sklearn-color-text);
        box-shadow: .3em .3em .4em #999;
        width: max-content;
        text-align: left;
        max-height: 10em;
        overflow-y: auto;

        /* unfitted */
        background: var(--sklearn-color-unfitted-level-0);
        border: thin solid var(--sklearn-color-unfitted-level-3);
    }

    /* Fitted state for parameter tooltips */
    .fitted .param-doc-description {
        /* fitted */
        background: var(--sklearn-color-fitted-level-0);
        border: thin solid var(--sklearn-color-fitted-level-3);
    }

    .param-doc-link:hover .param-doc-description {
        display: block;
    }

    .copy-paste-icon {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NDggNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNy4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTIwOCAwTDMzMi4xIDBjMTIuNyAwIDI0LjkgNS4xIDMzLjkgMTQuMWw2Ny45IDY3LjljOSA5IDE0LjEgMjEuMiAxNC4xIDMzLjlMNDQ4IDMzNmMwIDI2LjUtMjEuNSA0OC00OCA0OGwtMTkyIDBjLTI2LjUgMC00OC0yMS41LTQ4LTQ4bDAtMjg4YzAtMjYuNSAyMS41LTQ4IDQ4LTQ4ek00OCAxMjhsODAgMCAwIDY0LTY0IDAgMCAyNTYgMTkyIDAgMC0zMiA2NCAwIDAgNDhjMCAyNi41LTIxLjUgNDgtNDggNDhMNDggNTEyYy0yNi41IDAtNDgtMjEuNS00OC00OEwwIDE3NmMwLTI2LjUgMjEuNS00OCA0OC00OHoiLz48L3N2Zz4=);
        background-repeat: no-repeat;
        background-size: 14px 14px;
        background-position: 0;
        display: inline-block;
        width: 14px;
        height: 14px;
        cursor: pointer;
    }
    </style><body><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DSS(bias=&lt;mne_denoise.dss.denoisers.averaging.AverageBias object at 0x7ff148d22ba0&gt;,
        n_components=8)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>DSS</div></div><div><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted" data-param-prefix="">
            <div class="estimator-table">
                <details>
                    <summary>Parameters</summary>
                    <table class="parameters-table">
                      <tbody>
                    
            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('bias',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">bias</td>
                <td class="value">&lt;mne_denoise....x7ff148d22ba0&gt;</td>
            </tr>
    

            <tr class="user-set">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('n_components',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">n_components</td>
                <td class="value">8</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('rank',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">rank</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('reg',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">reg</td>
                <td class="value">1e-09</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('normalize_input',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">normalize_input</td>
                <td class="value">True</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('cov_method',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">cov_method</td>
                <td class="value">&#x27;empirical&#x27;</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('cov_kws',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">cov_kws</td>
                <td class="value">None</td>
            </tr>
    

            <tr class="default">
                <td><i class="copy-paste-icon"
                     onclick="copyToClipboard('return_type',
                              this.parentElement.nextElementSibling)"
                ></i></td>
                <td class="param">return_type</td>
                <td class="value">&#x27;sources&#x27;</td>
            </tr>
    
                      </tbody>
                    </table>
                </details>
            </div>
        </div></div></div></div></div><script>function copyToClipboard(text, element) {
        // Get the parameter prefix from the closest toggleable content
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const fullParamName = paramPrefix ? `${paramPrefix}${text}` : text;

        const originalStyle = element.style;
        const computedStyle = window.getComputedStyle(element);
        const originalWidth = computedStyle.width;
        const originalHTML = element.innerHTML.replace('Copied!', '');

        navigator.clipboard.writeText(fullParamName)
            .then(() => {
                element.style.width = originalWidth;
                element.style.color = 'green';
                element.innerHTML = "Copied!";

                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            })
            .catch(err => {
                console.error('Failed to copy:', err);
                element.style.color = 'red';
                element.innerHTML = "Failed!";
                setTimeout(() => {
                    element.innerHTML = originalHTML;
                    element.style = originalStyle;
                }, 2000);
            });
        return false;
    }

    document.querySelectorAll('.copy-paste-icon').forEach(function(element) {
        const toggleableContent = element.closest('.sk-toggleable__content');
        const paramPrefix = toggleableContent ? toggleableContent.dataset.paramPrefix : '';
        const paramName = element.parentElement.nextElementSibling
            .textContent.trim().split(' ')[0];
        const fullParamName = paramPrefix ? `${paramPrefix}${paramName}` : paramName;

        element.setAttribute('title', fullParamName);
    });


    /**
     * Adapted from Skrub
     * https://github.com/skrub-data/skrub/blob/403466d1d5d4dc76a7ef569b3f8228db59a31dc3/skrub/_reporting/_data/templates/report.js#L789
     * @returns "light" or "dark"
     */
    function detectTheme(element) {
        const body = document.querySelector('body');

        // Check VSCode theme
        const themeKindAttr = body.getAttribute('data-vscode-theme-kind');
        const themeNameAttr = body.getAttribute('data-vscode-theme-name');

        if (themeKindAttr && themeNameAttr) {
            const themeKind = themeKindAttr.toLowerCase();
            const themeName = themeNameAttr.toLowerCase();

            if (themeKind.includes("dark") || themeName.includes("dark")) {
                return "dark";
            }
            if (themeKind.includes("light") || themeName.includes("light")) {
                return "light";
            }
        }

        // Check Jupyter theme
        if (body.getAttribute('data-jp-theme-light') === 'false') {
            return 'dark';
        } else if (body.getAttribute('data-jp-theme-light') === 'true') {
            return 'light';
        }

        // Guess based on a parent element's color
        const color = window.getComputedStyle(element.parentNode, null).getPropertyValue('color');
        const match = color.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i);
        if (match) {
            const [r, g, b] = [
                parseFloat(match[1]),
                parseFloat(match[2]),
                parseFloat(match[3])
            ];

            // https://en.wikipedia.org/wiki/HSL_and_HSV#Lightness
            const luma = 0.299 * r + 0.587 * g + 0.114 * b;

            if (luma > 180) {
                // If the text is very bright we have a dark theme
                return 'dark';
            }
            if (luma < 75) {
                // If the text is very dark we have a light theme
                return 'light';
            }
            // Otherwise fall back to the next heuristic.
        }

        // Fallback to system preference
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }


    function forceTheme(elementId) {
        const estimatorElement = document.querySelector(`#${elementId}`);
        if (estimatorElement === null) {
            console.error(`Element with id ${elementId} not found.`);
        } else {
            const theme = detectTheme(estimatorElement);
            estimatorElement.classList.add(theme);
        }
    }

    forceTheme('sk-container-id-2');</script></body>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 307-309

Visualize Cardiac Components
----------------------------

.. GENERATED FROM PYTHON SOURCE LINES 309-325

.. code-block:: Python


    # 1. Score Curve
    plot_score_curve(dss_ecg, mode="ratio", show=False)

    # 2. Time Series
    # *   **Expectation**: Comp 0 should look like a QRS complex.
    plot_component_time_series(dss_ecg, data=ecg_epochs, n_components=8, show=False)

    # 3. Spatial Patterns
    # *   **Expectation**: Deep/distant field pattern.
    plot_spatial_patterns(dss_ecg, n_components=8, show=False)

    # 4. Summary
    plot_component_summary(dss_ecg, data=ecg_epochs, n_components=[0], show=False)





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_012.png
         :alt: Component Scores
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_012.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_013.png
         :alt: First 8 Component Time Series
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_013.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_014.png
         :alt: Comp 0, Comp 1, Comp 2, Comp 3, Comp 4, Comp 5, Comp 6, Comp 7, fT/cm
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_014.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_015.png
         :alt: Comp 0 Pattern, Comp 0 Time Course, PSD
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_015.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <Figure size 1200x300 with 3 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 326-328

Removing the Artifact
---------------------

.. GENERATED FROM PYTHON SOURCE LINES 328-353

.. code-block:: Python


    print("Removing cardiac component...")
    sources_ecg = dss_ecg.transform(raw_meg)  # Apply to continuous data

    sources_ecg[0, :] = 0  # Zero out heartbeat
    raw_clean_ecg = mne.io.RawArray(dss_ecg.inverse_transform(sources_ecg), raw_meg.info)

    # Verification
    ecg_epochs_clean = mne.Epochs(
        raw_clean_ecg,
        ecg_epochs.events,
        tmin=-0.1,
        tmax=0.1,
        baseline=(None, 0),
        verbose=False,
    )

    # Expectation 1: The QRS spike should be suppressed.
    plot_evoked_comparison(
        ecg_epochs, ecg_epochs_clean, show=False, labels=("Original", "Cleaned")
    )

    # Expectation 2: Cardiac harmonics (multiples of heart rate ~1.2 Hz) should be reduced,
    # while alpha/beta peaks remain.
    plot_psd_comparison(ecg_epochs, ecg_epochs_clean, fmax=40, show=True)



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_016.png
         :alt: Evoked Response Comparison (GFP)
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_016.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_017.png
         :alt: PSD Comparison
         :srcset: /auto_examples/dss/images/sphx_glr_plot_02_artifact_correction_017.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Removing cardiac component...
    Creating RawArray with float64 data, n_channels=203, n_times=36038
        Range : 0 ... 36037 =      0.000 ...    60.000 secs
    Ready.
    Using data from preloaded Raw for 59 events and 121 original time points ...
    42 bad epochs dropped
    Using data from preloaded Raw for 17 events and 121 original time points ...
        Using multitaper spectrum estimation with 7 DPSS windows
    Using data from preloaded Raw for 17 events and 121 original time points ...
        Using multitaper spectrum estimation with 7 DPSS windows

    <Figure size 640x480 with 1 Axes>



.. GENERATED FROM PYTHON SOURCE LINES 354-360

Conclusion
----------
We used DSS with **AverageBias** to find and remove stereotypic artifacts.
*   By epoching on the artifact events (blinks, heartbeats), we made the artifact "the signal of interest".
*   DSS isolated perfectly.
*   We removed it by zeroing the component.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 10.597 seconds)


.. _sphx_glr_download_auto_examples_dss_plot_02_artifact_correction.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_02_artifact_correction.ipynb <plot_02_artifact_correction.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_02_artifact_correction.py <plot_02_artifact_correction.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_02_artifact_correction.zip <plot_02_artifact_correction.zip>`
