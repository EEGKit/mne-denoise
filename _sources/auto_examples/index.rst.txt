:orphan:

Examples Gallery
================

This gallery contains examples demonstrating the usage of ``mne-denoise``.



.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. thumbnail-parent-div-close

.. raw:: html

    </div>

DSS Examples
============

Examples demonstrating Denoising Source Separation (DSS) for various use cases.

Basic DSS
---------
- ``plot_01_dss_fundamentals.py``: Core DSS concepts (Trial Average and Bandpass biases)
- ``plot_02_artifact_correction.py``: Removing artifacts using DSS
- ``plot_03_evoked_responses.py``: Enhancing event-related potentials

Spectral & Oscillatory DSS
--------------------------
- ``plot_04_spectral_dss.py``: Frequency-specific component extraction
- ``plot_05_periodic_dss.py``: SSVEP and periodic signal enhancement
- ``plot_06_temporal_dss.py``: Time-shift DSS for temporal structure
- ``plot_07_spectrogram_dss.py``: Time-frequency decomposition with DSS

Advanced DSS
------------
- ``plot_08_blind_source_separation.py``: Comparison with ICA
- ``plot_09_custom_bias.py``: Creating custom bias functions
- ``plot_10_benchmarking.py``: Performance evaluation
- ``plot_11_wiener_masking.py``: Nonlinear DSS with Wiener masks
- ``plot_12_joint_dss.py``: Multi-dataset repeatability (JDSS)

References
----------
- Särelä & Valpola (2005). Denoising Source Separation. J. Mach. Learn. Res.
- de Cheveigné & Simon (2008). Denoising based on spatial filtering. J. Neurosci. Methods.
- de Cheveigné & Parra (2014). Joint decorrelation. NeuroImage.



.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates the WienerMaskDenoiser, a nonlinear function that adapts to the local variance (envelope) of the signal.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_11_wiener_masking_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_11_wiener_masking`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">11. Adaptive Wiener Masking for Bursty Signals.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates Joint Denoising Source Separation (JDSS), a method for extracting components that are reproducible across multiple datasets.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_12_joint_dss_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_12_joint_dss`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Joint DSS (Multi-Dataset Repeatability).</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to extend DSS by defining custom bias criteria. This is useful when you have domain-specific knowledge about the target source (e.g., &quot;it has sharp gradients&quot;, &quot;it occurs after a specific trigger&quot;, etc.).">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_09_custom_bias_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_09_custom_bias`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">09. Custom DSS: Defining Your Own Bias.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how Nonlinear DSS can perform Blind Source Separation (BSS), effectively recovering independent sources from mixed signals. It explicitly shows the equivalence between DSS with specific nonlinearities and Independent Component Analysis (ICA).">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_08_blind_source_separation_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_08_blind_source_separation`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">08. Blind Source Separation & ICA Equivalence.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates DSS for extracting temporally structured signals: autocorrelated components, slow drifts, and smooth waveforms.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_06_temporal_dss_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_06_temporal_dss`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Temporal DSS: Time-Shift Regression & Smoothness.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to use DSS to enhance Evoked Responses (ERPs/ERFs). We explore two strategies: 1.  Standard Denoising: Using AverageBias to enhance the common evoked response (N100/P200). 2.  Contrast Enhancement: Building a Custom Bias to isolate the difference between two experimental conditions (Left vs Right Audio).">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_03_evoked_responses_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_03_evoked_responses`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Denoising Evoked Responses.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates the superior efficiency of DSS in recovering evoked responses compared to standard methods.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_10_benchmarking_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_10_benchmarking`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">10. Efficiency Benchmark: DSS vs PCA, ICA, and Averaging.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates DSS for extracting transient oscillatory bursts using time-frequency (TF) domain constraints via spectrogram masking.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_07_spectrogram_dss_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_07_spectrogram_dss`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Time-Frequency DSS: Spectrogram Masking.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="DSS is a powerful tool for removing artifacts (ECG, EOG) from data. The core idea is: Artifacts are repetitive.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_02_artifact_correction_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_02_artifact_correction`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Artifact Correction with DSS.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example comprehensively demonstrates periodic signal extraction using DSS.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_05_periodic_dss_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_05_periodic_dss`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Example 5: Periodic Signals (SSVEP & Quasi-Periodic).</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This tutorial introduces Denoising Source Separation (DSS), a technique for extracting brain sources based on a specific criterion of &quot;interestingness&quot; (bias).">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_01_dss_fundamentals_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_01_dss_fundamentals`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Fundamentals of DSS.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates how to use DSS to isolate oscillatory brain rhythms (e.g., Alpha, Beta) using spectral biases.">

.. only:: html

  .. image:: /auto_examples/dss/images/thumb/sphx_glr_plot_04_spectral_dss_thumb.png
    :alt:

  :doc:`/auto_examples/dss/plot_04_spectral_dss`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">Denoising Rhythms (Spectral DSS).</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>

ZapLine Examples
================

Examples demonstrating the ZapLine algorithm for power line noise removal.

ZapLine uses DSS (Denoising Source Separation) to find and remove spatial
components that carry power line artifacts (50/60 Hz and harmonics).

References:

- de Cheveigné, A. (2020). ZapLine: A simple and effective method to remove
  power line artifacts. NeuroImage, 207, 116356.
- Klug, M., & Kloosterman, N. A. (2022). Zapline-plus: A Zapline extension for
  automatic and adaptive removal of frequency-specific noise artifacts in M/EEG.
  Human Brain Mapping, 43(12), 3824-3839.


Data Sources from the ZapLine Paper
-----------------------------------

The original ZapLine paper (de Cheveigné, 2020) evaluated the method on three
types of data. Here we document these sources for reproducibility.

**1. Simulated Data (10000×100)**

The paper generates synthetic data with:

- **Signal**: Gaussian random noise (broadband), 10000 samples × 100 channels
- **Line noise**: Sinusoid → half-wave rectified → raised to power 3
- Spatial topography via multiplication by random 1×100 matrix
- Signal and noise scaled to approximately equal power (0 dB SNR)
- **ZapLine d = 1** (single spatial component removed)

Use ``data/simulation.py:generate_zapline_paper_simulation()`` to reproduce.

**2. EEG Data: Di Liberto et al. (2015)**

- **Channels**: 136 (BioSemi)
- **Sampling rate**: 512 Hz
- **ZapLine d = 2**
- **Citation**: Di Liberto, G. M., et al. (2015). Low-frequency cortical
  entrainment to speech reflects phoneme-level processing. Current Biology.

Download options:

- **OpenNeuro**: Dataset ``ds004408`` (EEG responses to continuous naturalistic speech)

  .. code-block:: bash

      # Option 1: OpenNeuro CLI
      pip install openneuro-py
      openneuro download --dataset ds004408 --snapshot 1.0.8 --out ./di_liberto_eeg

      # Option 2: DataLad
      datalad install https://github.com/OpenNeuroDatasets/ds004408.git

**3. MEG Data: Yokogawa System**

- **Channels**: 166
- **Sampling rate**: 200 Hz (downsampled)
- **ZapLine d = 4**
- **Note**: The paper does not identify a public repository for this dataset.
  The NoiseTools example page may contain the specific file.


Additional Data Sources (NoiseTools Examples)
---------------------------------------------

The NoiseTools MATLAB toolbox provides 8 example scripts with various real
datasets. Data download links are embedded in the MATLAB scripts:

http://audition.ens.fr/adc/NoiseTools/src/NoiseTools/EXAMPLES/zapline/

**Example 1: Monkey ECoG (FieldTrip)**

- **Source**: FieldTrip tutorial data
- **Line freq**: 50 Hz, **d = 4**
- **Download**: ``ftp://ftp.fieldtriptoolbox.org/pub/fieldtrip/tutorial/monkey_ecog/data.mat``

**Example 2: Resting EEG (Trujillo et al.)**

- **Citation**: Trujillo et al. (2017). DOI: 10.3389/fnins.2017.00425
- **Channels**: 66, **Line freq**: 60 Hz, **d = 3**
- **Download**: https://doi.org/10.18738/T8/ANS9Q1

**Examples 3-6: NoiseTools MEG/EEG**

- From NoiseTools example data (available via NoiseTools download)
- Various configurations of epoched and continuous data

**Example 7: Saline Phantom EEG**

- EEG from electrodes in saline in glass within shielded booth
- Minimal artifact, minimal removal (demonstration of safety)

**Example 8: High Sample Rate Resting EEG**

- **Source**: DataDryad
- **Download**: https://datadryad.org/resource/doi:10.5061/dryad.v9f16


Quick Start with MNE Sample Data
--------------------------------

For convenience, our examples primarily use:

1. **Synthetic data** (auto-generated, no download needed)
2. **MNE Sample dataset** (auto-downloads via ``mne.datasets.sample.data_path()``)

This ensures all examples work out-of-the-box without manual data setup.

.. code-block:: python

    # Example: Use MNE sample data
    import mne
    data_path = mne.datasets.sample.data_path()
    raw = mne.io.read_raw_fif(data_path / 'MEG/sample/sample_audvis_raw.fif')


Files in This Directory
-----------------------

- ``plot_01_zapline_fundamentals.py``: Basic ZapLine usage on synthetic data
- ``plot_02_zapline_parameters.py``: Parameter tuning and component selection
- ``plot_03_zapline_epochs.py``: Apply ZapLine to epoched MNE data
- ``plot_04_zapline_plus_paper.py``: Zapline-plus adaptive cleaning on non-stationary data
- ``plot_05_zapline_plus_advanced.py``: Advanced features (harmonics, topographies, hybrid fallback)
- ``data/simulation.py``: Paper-faithful simulation generator



.. raw:: html

    <div class="sphx-glr-thumbnails">

.. thumbnail-parent-div-open

.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example demonstrates the advanced features of Zapline-plus: 1. Harmonic Processing: Auto-detect and remove harmonics (2f, 3f, ...) 2. Hybrid Fallback: Notch filter cleanup when ZapLine struggles 3. Topography Outputs: Per-chunk spatial patterns of removed artifacts 4. Chunk Metadata: Detailed per-segment cleaning information">

.. only:: html

  .. image:: /auto_examples/zapline/images/thumb/sphx_glr_plot_05_adaptive_advanced_thumb.png
    :alt:

  :doc:`/auto_examples/zapline/plot_05_adaptive_advanced`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">ZapLine-plus: Advanced Settings and Features</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This tutorial demonstrates ZapLine for removing power line noise (50/60 Hz).">

.. only:: html

  .. image:: /auto_examples/zapline/images/thumb/sphx_glr_plot_01_basic_usage_thumb.png
    :alt:

  :doc:`/auto_examples/zapline/plot_01_basic_usage`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">ZapLine: Line Noise Removal Fundamentals.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This tutorial demonstrates: 1. ZapLine with epoched MEG data (NoiseTools data3.mat) 2. High-channel MEG data (NoiseTools example_data.mat) 3. The sklearn-style Transformer API">

.. only:: html

  .. image:: /auto_examples/zapline/images/thumb/sphx_glr_plot_03_epoched_data_thumb.png
    :alt:

  :doc:`/auto_examples/zapline/plot_03_epoched_data`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">ZapLine: Epoched Data and Real Data Examples.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This tutorial covers: 1. Parameter exploration (n_remove, nkeep, threshold) 2. Real MEG data from NoiseTools 3. Comparing different parameter settings">

.. only:: html

  .. image:: /auto_examples/zapline/images/thumb/sphx_glr_plot_02_parameter_tuning_thumb.png
    :alt:

  :doc:`/auto_examples/zapline/plot_02_parameter_tuning`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">ZapLine: Parameter Tuning and Real Data.</div>
    </div>


.. raw:: html

    <div class="sphx-glr-thumbcontainer" tooltip="This example replicates the core demonstrations from the Zapline-plus paper, showing the adaptive cleaning process on synthetic data.">

.. only:: html

  .. image:: /auto_examples/zapline/images/thumb/sphx_glr_plot_04_adaptive_mode_thumb.png
    :alt:

  :doc:`/auto_examples/zapline/plot_04_adaptive_mode`

.. raw:: html

      <div class="sphx-glr-thumbnail-title">ZapLine-plus: Paper-Faithful Example (Klug & Kloosterman 2022)</div>
    </div>


.. thumbnail-parent-div-close

.. raw:: html

    </div>


.. toctree::
   :hidden:
   :includehidden:


   /auto_examples/dss/index.rst
   /auto_examples/zapline/index.rst

